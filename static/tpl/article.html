<div class="pure-g-r wrap">
    <div class="pure-u-3-4">
        <article class="panel" id="{{article._id}}">
            <header class="article-header">
                <h3>{{article.title}}<a ng-show="isMe||isEditor" ng-href="{{'/'+article._id+'/edit'}}"><i class="icon-pencil success" title="编辑"></i></a></h3>
                <div class="article-info">
                    <a ng-href="{{article.refer.url}}" title="原文"><i class="icon-external-link-sign success"></i>{{article.refer.url | cutText:25}}</a>
                    <i class="icon-time" data-original-title="{{article.date | formatDate:true}}发布" gen-tooltip> {{article.date | formatDate}}</i>
                    <i class="icon-refresh" data-original-title="{{article.updateTime | formatDate:true}}更新" gen-tooltip> {{article.updateTime | formatDate}}</i>
                    <i class="icon-eye-open" title="访问"> {{article.visitors}}</i>
                    <i class="icon-star-empty" title="热度"> {{article.hots}}</i>
                    <i class="icon-comments-alt" title="评论" ng-show="article.comments"> {{article.comments}}</i>
                    <a ng-repeat="tag in article.tagsList" ng-href="{{'/'+tag._id}}" class="pure-button pure-button-link">{{tag.tag}}</a>
                </div>
            </header>
            <section class="article-content" gen-parse-md="article.content">
            </section>
            <footer class="pure-g-r article-footer">
                <div class="pure-u-1-2">
                    <div class="article-info" ng-show="article.collection">
                        <span>所属合集：</span>
                        <a ng-href="{{'/'+article.collection._id}}">{{article.collection.title}}</a>
                    </div>
                    <div class="article-info" ng-show="article.favorsList">
                        <span>支持：</span>
                        <span ng-repeat="user in article.favorsList">
                            <a ng-href="{{'/'+user._id}}">{{user.name}}</a>
                        </span>
                    </div>
                    <div class="article-info" ng-show="article.opposesList">
                        <span>反对：</span>
                        <span ng-repeat="user in article.opposesList">
                            <a ng-href="{{'/'+user._id}}">{{user.name}}</a>
                        </span>
                    </div>
                    <div class="article-info" ng-show="article.markList">
                        <span>收藏：</span>
                        <span ng-repeat="user in article.markList">
                            <a ng-href="{{'/'+user._id}}">{{user.name}}</a>
                        </span>
                    </div>
                </div>
                <div class="pure-u-1-2 text-right">
                    <div class="pure-button-group">
                        <button class="pure-button pure-button-small info-bg" ng-click="setFavor(article)">
                            <i ng-class="{'icon-thumbs-up':article.isFavor,'icon-thumbs-up-alt':!article.isFavor}" title="支持"></i> {{article.favorsList.length}}
                        </button>
                        <button class="pure-button pure-button-small primary-bg" ng-click="setMark(article)">
                            <i ng-class="{'icon-bookmark':article.isMark,'icon-bookmark-empty':!article.isMark}" title="收藏"></i> {{article.markList.length}}
                        </button>
                        <button class="pure-button pure-button-small info-bg" ng-click="setOppose(article)">
                            <i ng-class="{'icon-thumbs-down':article.isOppose,'icon-thumbs-down-alt':!article.isOppose}" title="反对"></i> {{article.opposesList.length}}
                        </button>
                    </div>
                    <div class="pure-button-group">
                        <button ng-click="reply(article)" class="pure-button pure-button-small success-bg">发表评论<i class="icon-reply"></i></button>
                    </div>
                </div>
            </footer>
        </article>
        <aside class="panel" id="comments">
            <section id="reply" class="inner">
                <h4>{{replyTitle}}</h4>
                <div id="wmd-preview" class="wmd-preview" ng-show="wmdShow=='preview'">
                </div>
                <div class="wmd-preview" ng-show="wmdShow=='help'" gen-parse-md="markdownHelp">
                </div>
                <form class="pure-form" ng-show="wmdShow=='edit'">
                    <div id="wmd-button-bar"></div>
                    <textarea class="wmd-input pure-input-1" id="wmd-input" ng-model="content" rows="6" required>
                    </textarea>
                </form>
                <div class="article-info">
                    [使用<a ng-click="wmdHelp('help')">MarkDown语法</a>，{{global.ContentMinLen}} 到 {{global.ContentMaxLen}} 字节，当前<strong class="hot">{{contentBytes}}</strong>字节]
                </div>
                <div class="text-right">
                    <div class="pure-button-group">
                        <button class="pure-button pure-button-small success-bg" ng-click="wmdHelp('preview')">文章预览</button>
                        <button class="pure-button pure-button-small success-bg" ng-click="wmdHelp('edit')">编辑文章</button>
                    </div>
                    <div class="pure-button-group">
                        <button ng-click="reply(article)" class="pure-button pure-button-small primary-bg" ng-show="replyToComment">取&nbsp;&nbsp;消</button>
                    </div>
                    <div class="pure-button-group">
                        <button ng-click="submit()" class="pure-button pure-button-small primary-bg">提&nbsp;&nbsp;交</button>
                    </div>
                </div>
            </section>
            <ul class="media-list comments">
                <li class="media" ng-animate="{enter:'fadeInDown',leave:'fadeOutDown'}" ng-repeat="comment in article.commentsList">
                  <a class="media-object left" ng-href="{{'/'+comment.author._id}}">
                    <img class="img-small" ng-src="{{comment.author.avatar||'/static/img/avatar.png'}}">
                  </a>
                  <div class="media-body" id="{{comment._id}}">
                    <header class="media-heading">
                        <a ng-click="getComments(comment.refer._id, comment)">{{comment.title}}</a>
                    </header>
                    <div class="media-content list-content" gen-parse-md="comment.content"></div>
                    <footer class="pure-g-r media-footer">
                        <div class="pure-u-1-2"><a ng-href="{{'/'+comment.author._id}}">{{comment.author.name}}</a> {{comment.date | formatDate}}发表</div>
                        <div class="pure-u-1-2 text-right">
                            <div class="pure-button-group">
                                <button class="pure-button pure-button-mini" ng-click="setFavor(comment)">
                                    <i ng-class="{'icon-thumbs-up':comment.isFavor,'icon-thumbs-up-alt':!comment.isFavor}" title="支持"> {{comment.favorsList.length}}</i>
                                </button>
                                <button class="pure-button pure-button-mini" ng-click="getComments(comment.commentsList, comment)">
                                    <i class="icon-comments-alt" title="评论"></i> {{comment.commentsList.length}}
                                </button>
                                <button class="pure-button pure-button-mini" ng-click="setOppose(comment)">
                                    <i ng-class="{'icon-thumbs-down':comment.isOppose,'icon-thumbs-down-alt':!comment.isOppose}" title="反对"></i> {{comment.opposesList.length}}
                                </button>
                            </div>
                            <div class="pure-button-group">
                                <button class="pure-button pure-button-mini" ng-click="reply(comment)" class="pure-button pure-button-primary">回复<i class="icon-reply"></i></button>
                            </div>
                        </div>
                    </footer>
                  </div>
                </li>
            </ul>
            <ul id="refer-comments" class="media-list comments">
                <li class="media" ng-repeat="comment in referComments">
                  <a class="media-object left" ng-href="{{'/'+comment.author._id}}">
                      <img class="img-small" ng-src="{{comment.author.avatar||'/static/img/avatar.png'}}">
                  </a>
                  <div class="media-body">
                    <header class="media-heading">
                        {{comment.title}}
                    </header>
                    <div class="media-content list-content" gen-parse-md="comment.content"></div>
                    <footer class="pure-g-r media-footer">
                        <div class="pure-u-1-2"><a ng-href="{{'/'+comment.author._id}}">{{comment.author.name}}</a> {{comment.date | formatDate}}发表</div>
                        <div class="pure-u-1-2 text-right">
                            <div class="pure-button-group">
                                <button class="pure-button pure-button-mini" ng-click="setFavor(comment)">
                                    <i ng-class="{'icon-thumbs-up':comment.isFavor,'icon-thumbs-up-alt':!comment.isFavor}" title="支持"> {{comment.favorsList.length}}</i>
                                </button>
                                <button class="pure-button pure-button-mini" ng-click="setOppose(comment)">
                                    <i ng-class="{'icon-thumbs-down':comment.isOppose,'icon-thumbs-down-alt':!comment.isOppose}" title="反对"></i> {{comment.opposesList.length}}
                                </button>
                            </div>
                        </div>
                    </footer>
                  </div>
                </li>
            </ul>
            <section class="pull-left" gen-pagination="pagination" ng-show="pagination"></section>
        </aside>
    </div>
    <div class="pure-u-1-4 aside">
        <div class="panel">
            <header class="panel-heading">作者信息</header>
            <div class="media inner">
                <a class="media-object left" ng-href="{{'/'+article.author._id}}">
                    <img class="img-small" ng-src="{{article.author.avatar||'/static/img/avatar.png'}}">
                </a>
                <div class="media-body">
                    <header class="media-header"><a ng-href="{{'/'+article.author._id}}">{{article.author.name}}</a></header>
                    <button class="pure-button success-bg" ng-show="!isMe" ng-click="followMe(article.author)">{{article.author.isFollow | follow}}</button>
                </div>
            </div>
            <ul class="inner list-inline article-info">
                <li>
                    <strong class="hot">{{article.author.role | role}}</strong>
                </li>
                <li ng-show="article.author.score">
                    积分：<strong>{{article.author.score}}</strong>
                </li>
                <li ng-show="article.author.fans">
                    粉丝：<strong>{{article.author.fans}}</strong>
                </li>
                <li ng-show="article.author.follow">
                    关注：<strong>{{article.author.follow}}</strong>
                </li>
                <li ng-show="article.author.articles">
                    文章/评论：<strong>{{article.author.articles}}</strong>
                </li>
                <li ng-show="article.author.collections">
                    合集：<strong>{{article.author.collections}}</strong>
                </li>
            </ul>
        </div>
        <div class="panel">
            <header class="panel-heading">作者文章</header>
            <ul class="media-list comments">
                <li ng-repeat="article in authorArticles">
                    <mark>{{article.date | formatDate}}</mark>&nbsp;<a ng-href="{{'/'+article._id}}" title="{{article.author.name+'发表'}}">{{article.title}}</a>
                </li>
            </ul>
        </div>
        <div class="panel">
            <header class="panel-heading">热门文章</header>
            <ul class="media-list comments">
                <li class="media" ng-repeat="article in hotArticles">
                  <div class="media-body" id="{{article._id}}">
                    <em class="hot" title="热度">{{article.hots}}</em>&nbsp;
                    <span class="media-content"><a ng-href="{{'/'+article._id}}" title="{{article.author.name+'发表'}}">{{article.title}}</a></span>
                  </div>
                </li>
            </ul>
        </div>
    </div>
</div>
